import numpy as np
import scipy.stats as stats

"""
–ó–∞–¥–∞–Ω–∏–µ-1:
–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º, —Ä–∞–≤–Ω—ã–º 16.
–ù–∞–π—Ç–∏ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è m —Å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é 0.95,
–µ—Å–ª–∏ –≤—ã–±–æ—Ä–æ—á–Ω–∞—è —Å—Ä–µ–¥–Ω—è—è M = 80, –∞ –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏ n = 256.
"""

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
sigma = 16
alfa = 1 - 0.95
n = 256
M = 80

# –†–∞—Å—á–µ—Ç
# –ü–æ —É—Å–ª–æ–≤–∏—é –∑–∞–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã.
# –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —á–µ—Ä–µ–∑ z-–∫—Ä–∏—Ç–µ—Ä–∏–π:
# ùë•ÃÖ ¬± ùëß_(ùõº/2) * ùúé/‚àöùëõ, –µ—Å–ª–∏ ùúé –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞
z_alfa = stats.norm.ppf(1-alfa/2)           # –∫–≤–∞–Ω—Ç–∏–ª—å –¥–ª—è –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∞

# –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ M = 80, –æ–±—ä–µ–º–æ–º –≤—ã–±–æ—Ä–∫–∏ n = 256
z_delta = z_alfa * sigma / np.sqrt(n)

confidence_l = round(M - z_delta, 2)
confidence_r = round(M + z_delta, 2)

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print('–ó–∞–¥–∞–Ω–∏–µ-1.')
print('--------------------------------')
print(f'–î–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ —Å ùúé = {sigma}, –≤—ã–±–æ—Ä–æ—á–Ω–æ–π —Å—Ä–µ–¥–Ω–µ–π X_ = {M} –∏ –æ–±—ä–µ–º–æ–º –≤—ã–±–æ—Ä–∫–∏ n = {n}:')
print(f'–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–∞—Ç.–æ–∂–∏–¥–∞–Ω–∏—è —Å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é {1-alfa} —Å–æ—Å—Ç–∞–≤–∏—Ç: '
      f'[{confidence_l} ... {confidence_r}]')


"""
–ó–∞–¥–∞–Ω–∏–µ 2.
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ 10 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –≤–µ–ª–∏—á–∏–Ω—ã X, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, 
–ø–æ–ª—É—á–µ–Ω—ã –æ–ø—ã—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1
–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –∑–∞–∫–æ–Ω—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, 
–æ—Ü–µ–Ω–∏—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã X –ø—Ä–∏ –ø–æ–º–æ—â–∏ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, 
–ø–æ–∫—Ä—ã–≤–∞—é—â–µ–≥–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0,95.
"""

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
X = np.array([6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1])
alfa = 1 - 0.95
n = 10

# –†–∞—Å—á–µ—Ç
# –ü–æ —É—Å–ª–æ–≤–∏—é –∑–∞–¥–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏.
# –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —á–µ—Ä–µ–∑ t-–∫—Ä–∏—Ç–µ—Ä–∏–π:
# ùë•ÃÖ ¬± t_(ùõº/2) * ùúé/‚àöùëõ, –µ—Å–ª–∏ ùúé –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–∞
M = 0 + np.mean(X)                        # —Å—Ä–µ–¥–Ω—è—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X
d = np.var(X, ddof=1)                     # –¥–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X
t_alfa = stats.t.ppf(1-alfa/2, (n-1))     # –∫–≤–∞–Ω—Ç–∏–ª—å –¥–ª—è –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

# –ò—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã X –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ
z_delta = t_alfa * np.sqrt(d/n)

confidence_l = round(M - z_delta, 2)
confidence_r = round(M + z_delta, 2)

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-2.')
print('--------------------------------')
print(f'–ò—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã X = {X}, —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º M = {round(M, 3)}\n'
      f'—Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é = {1-alfa} '
      f'–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [{confidence_l} ... {confidence_r}]')


"""
–ó–∞–¥–∞–Ω–∏–µ 3.
–†–æ—Å—Ç –≤–∑—Ä–æ—Å–ª—ã—Ö –¥–æ—á–µ—Ä–µ–π: (175, 167, 154, 174, 178, 148, 160, 167, 169, 170)
–†–æ—Å—Ç –º–∞—Ç–µ—Ä–µ–π: (178, 165, 165, 173, 168, 155, 160, 164, 178, 175)
–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å 95% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–æ—Å—Ç–∞ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏ –¥–µ—Ç–µ–π.
"""

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
X1 = np.array([175, 167, 154, 174, 178, 148, 160, 167, 169, 170])
X2 = np.array([178, 165, 165, 173, 168, 155, 160, 164, 178, 175])
alfa = 1 - 0.95

# –†–∞—Å—á–µ—Ç
# –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ 2-—Ö –≤—ã–±–æ—Ä–æ–∫ —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –ø–æ —Ñ–æ—Ä–º—É–ª–∞–º
# Œî ¬± ùë°_(ùõº/2) ‚àó ùëÜ_Œî, –≥–¥–µ Œî= ùëã1_mean ‚àí ùëã2_mean
# ùê∑ = 1/2(ùê∑_1 + ùê∑_2), –≥–¥–µ   ùê∑_1 –∏ ùê∑_2 ‚Äì –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø
# ùëÜ_Œî = ‚àö(ùê∑/ùëõ_1 + ùê∑/ùëõ_2 ), –≥–¥–µ ùëõ_1 –∏ ùëõ_2 ‚Äì –æ–±—ä–µ–º—ã –≤—ã–±–æ—Ä–æ–∫.
# ùëëùëì = 2‚àó(ùëõ‚àí1), –≥–¥–µ n - –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏

n1          = np.size(X1)           # —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ X1
n2          = np.size(X2)           # —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ X2
X1_mean     = 0 + np.mean(X1)       # —Å—Ä–µ–¥–Ω—è—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X1
X2_mean     = 0 + np.mean(X2)       # —Å—Ä–µ–¥–Ω—è—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X2
delta       = X1_mean - X2_mean     # —Ä–∞–∑–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–Ω–∏—Ö
D1          = np.var(X1, ddof=1)    # –¥–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X1
D2          = np.var(X2, ddof=1)    # –¥–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ –≤—ã–±–æ—Ä–∫–µ X1

D       = (D1 + D2) / 2
S_delta = np.sqrt(D * (1/n1 + 1/n2))
df      = n1 + n2 - 2               # –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏

t_alfa = stats.t.ppf(1-alfa/2, df)  # –∫–≤–∞–Ω—Ç–∏–ª—å –¥–ª—è –ø—Ä–∞–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
delta_l = delta - t_alfa * S_delta  # –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
delta_r = delta + t_alfa * S_delta  # –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-3.')
print('---------------------------------')
print(f'{int((1-alfa) * 100)}% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª '
      f'–¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–æ—Å—Ç–∞ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏ –¥–µ—Ç–µ–π, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∞–º–∏:\n'
      f' - –î–µ—Ç–∏     X1 = {X1}\n'
      f' - –†–æ–¥–∏—Ç–µ–ª–∏ X2 = {X1}\n'
      f'—Ä–∞–≤–µ–Ω [{delta_l} ... {delta_r}]')
